"""mapper.py"""

import sys
import os


# input comes from STDIN (standard input)
length=0
circle=""
comlist="526	1539	1579	1642	1852	1317	1585	1736	1554	1603	1572	946	1553	1191	1666	1547	1288	1494	929	1722	990	1329	1050	1048	1805	1182	1799	983	1195	1594	1144	1092	1112	927	925	1600	1146	1597	1584	1851	1198	1435	1619	1181	1184	1107	1724	1845	950	1344	1523	1054	1836	1140	1593	1827	1752	1522	1708	1367	1377	1608	1519	1116	1126	1641	1842	1726	1174	1026	1088	1087	1219	952	1073	1398	1735	980	1447	951	1620	1823	1132	1039	1272	1789	1678	1613	1612	1361	1411	1761	1793	1669	1172	1135	1886	1557	1098	1819	1540	1480	1750	967	1321	1391	1034	1422	1902	1049	1477	982	1151	1161	1029	1561	1271	1484	1559	1178	1697	1791	1683	1101	947	1803	978	1517	1588	1817	1293	1008	1684	1509	1653	1278	1710	961	1637	922	1242	920	1753	1846	1290	1058	1795	1470	1076	934	1250	1676	1617	1351	1614	1883	1369	1700	991	1719	1535	1746	921	1352	1441	1405	1376	1555	1460	1123	1416	1467	1644	1843	1079	1006	1074	1513	1792	1449	1450	1085	1458	1305	966	1128	1774	1867	1757	1380	414	1888	1730	1420	1758	1145	1086	1485	1149	1737	1800	1675	1003	1714	1056	916	996	1075	1769	1589	1796	1238	1431	1124	1471	1330	1702	1668	1721	906	1544	1610	1390	1084	1243	1865	1863	1765	1521	1201	926	1534	1701	1698	1532	1402	1663	1360	1809	1301	1528	1211	1209	1900	1365	1835	1291	1652	1689	1813	1838	1505	1089	1165	1524	1445	1283	1659	1312	1214	1623	1622	1327	1267	1269	923	1580	1816	1779	1251	1197	1861	1558	1193	1017	1375	1068	1643	1055	1069	1516	1877	1639	1811	1491	1520	1328	1551	1031	1717	1028	1833	1688	1421	1059	1563	1626	1564	1537	1723	1265	908	1110	1339	1384	1334	1621	1077"


def Intersection(lst1,lst2):
	return set(lst1).intersection(lst2)

for line in sys.stdin:
	
    filepath = os.environ['mapreduce_map_input_file']
    filename = os.path.split(filepath)[-1]
    # remove leading and trailing whitespace
    line = line.strip()
    # split the line into words
    words = line.split()
    circle=words.pop(0)
    
    
    gwords=comlist.split('\t')
    
    length=len(Intersection(gwords,words))
    print(filename+" "+circle+" "+str(length))
    
    
    
    



	

    
    
    

    
    
    
   
   
